쿠키, 세션, 토큰의 본질
-----------------------------------------------
3개 모두 사용자를 식별하고 인증 상태를 유지하기 위해 사용됩니다.

쿠키(Cookie)
--------------------------------------------------------------------
- 쿠키(Cookie)는 클라이트가 가지고 있는 작은 메모장과 같습니다.
- 브라우저는 서버에서 받은 작은 데이터 조각을 자기 메모리에 저장하고, 이후 요청마다 헤더에 담겨서 서버에 자동으로 같이 전송하게 됩니다.

- 이러한 쿠키는 브라우저(클라이언트)에 저장되게 되고 보통은 4KB로 크기 제한이 존재합니다.
- 자동 전송되기 때문에 보안 측면에서 주의할 필요가 있습니다.

```
Set-Cookie: userId=1234; Expires=Fri, 31 Mar 2025 23:59:59 GMT;
```

세션(Session)
-------------------------------------------------------------------
- 세션(Session)은 서버가 사용하는 고정 좌석 번호와 같습니다.
- 서버는 사용자를 구별하기 위해 세션 ID를 발급하는데, 이 세션 ID는 클라이언트의 쿠키에 저장되게 됩니다.
- 실제 데이터는 서버 메모리(DB나 Redis 등)에 저장되게 됩니다.

- 즉, 클라이언트가 보내는 건 세션 ID 뿐이고 서버는 이 세션 ID에 해당하는 사용자를 찾아서 데이터를 제공하게 됩니다.

쿠키와 세션의 작동 방식
------------------------------------------------------------------
- 클라이언트가 로그인을 요청합니다.
- 서버가 세션 ID를 생성해서 세션 데이터를 저장합니다.
- 이후 세션 ID를 쿠키로 응답합니다.
- 이후 요청 시에는 세션 ID가 자동으로 전송됩니다.
- 서버는 세션 ID로 사용자를 식별합니다.

토큰(Token)
------------------------------------------------------------------
- 토큰은 클라이언트가 들고 다니는 인증 배지와 같습니다.
- 서버는 사용자를 인증한 후 JWT와 같은 토큰을 생성해서 클라이언트에 전달합니다.
- 클라이언트는 이 토큰을 저장해서 요청마다 직접 헤더에 포함해서 보냅니다.

- 보통은 JWT(JSON Web Token)을 사용합니다.
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

쿠키 vs 세션 vs 토큰의 개념 비교
----------------------------------------------
<table border="1">
  <thead>
    <tr>
      <th>구분</th>
      <th>쿠키 (Cookie)</th>
      <th>세션 (Session)</th>
      <th>토큰 (Token)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>저장 위치</td>
      <td>클라이언트 (브라우저)</td>
      <td>서버</td>
      <td>클라이언트 (주로 로컬스토리지)</td>
    </tr>
    <tr>
      <td>식별자 보관</td>
      <td>브라우저가 쿠키에 저장</td>
      <td>서버가 세션ID와 데이터를 저장</td>
      <td>클라이언트가 토큰 자체를 저장</td>
    </tr>
    <tr>
      <td>전송 방식</td>
      <td>HTTP 요청 시 자동 전송</td>
      <td>세션 ID만 쿠키로 전송됨</td>
      <td>클라이언트가 직접 헤더에 넣음</td>
    </tr>
    <tr>
      <td>인증 상태</td>
      <td>상태 유지 (Stateful)</td>
      <td>상태 유지 (Stateful)</td>
      <td>무상태 (Stateless)</td>
    </tr>
    <tr>
      <td>만료 관리</td>
      <td>클라이언트가 관리</td>
      <td>서버가 관리</td>
      <td>클라이언트가 관리</td>
    </tr>
    <tr>
      <td>확장성</td>
      <td>낮음</td>
      <td>낮음</td>
      <td>높음</td
  </tr>
  </tbody>
</table>

쿠키, 세션, 토큰 외우는 방법
-------------------------------------------------
<table border="1">
  <thead>
    <tr>
      <th>기억법</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>쿠키</td>
      <td>브라우저가 저장 (클라이언트 중심)</td>
    </tr>
    <tr>
      <td>세션</td>
      <td>서버가 저장 (서버 중심, 상태 있음)</td>
    </tr>
    <tr>
      <td>토큰</td>
      <td>클라이언트가 들고 다님, 서버는 기억 안 함 (Stateless)</td>
    </tr>
  </tbody>
</table>

실무에서의 사용
-----------------------------------------------------
<table border="1">
  <thead>
    <tr>
      <th>상황</th>
      <th>추천 방식</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>전통적인 웹 로그인</td>
      <td>세션</td>
    </tr>
    <tr>
      <td>SPA, 모바일 앱, API 서버, 마이크로서비스</td>
      <td>토큰 (JWT)</td>
    </tr>
    <tr>
      <td>임시 저장 정보 (장바구니 등)</td>
      <td>쿠키</td>
    </tr>
  </tbody>
</table>
