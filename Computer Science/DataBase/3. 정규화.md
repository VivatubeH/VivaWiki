정규화(Normalization)
---------------------------------------------------------
- 데이터베이스 테이블을 구조화해서 중복 데이터를 최소화하고 무결성을 유지하는 방법을 정규화라고 합니다.
- 정규화를 통해 데이터를 깔끔하고 효율적으로 관리할 수 있습니다.

정규화의 목적
------------------------------------------------------
- 데이터 중복 제거 : 동일한 데이터를 여러 곳에 저장하지 않도록 합니다.
- 데이터 무결성 확보 : 데이터가 일관성을 가지도록 유지합니다.
- 저장 공간 절약 : 불필요한 데이터 저장을 줄여서 공간 효율성을 향상 시킵니다.
- 데이터 갱신 이상 방지 : 데이터 수정 시 모든 곳을 수정하는 불필요성을 없앱니다.

정규화의 단계 
-----------------------------------------------------
- 정규화는 여러 단계로 이루어집니다.
- 정규화는 총 5단계로 이루어지는데, 보통 실무에서는 3단계까지를 다루는 경우가 많습니다.
- 이는 너무 복잡하게 쪼개게 되면 조인(Join)이 많아져서 성능 하락으로 이어지기 때문입니다.
- 보통은 3NF까지 정규화하고, 성능 문제가 생기면 반정규화로 조정하는 것이 일반적입니다.

#### 1NF (제1정규형) : 원자성(Atomicity)
- 모든 속성의 값이 더 이상 쪼갤 수 없는 원자값으로 구성되어야 합니다. 
- 모든 칸(필드)에는 하나의 값만 들어가야 합니다. ( 중복된 칸이나 여러 값이 한 칸에 있는 것을 없애는 게 목적입니다. )

- 잘못된 예와 올바른 예
  
```
이름       | 연락처
----------|------------------
철수       | 010-1111-1111, 010-2222-2222
```

```  
이름       | 연락처
----------|--------------
철수       | 010-1111-1111
철수       | 010-2222-2222
```

  
#### 2NF (제2정규형) : 부분 함수 종속 제거
- 기본키의 일부에만 종속된 속성을 없애는 것이 2NF입니다.
- 즉, 종속되려면 기본키 전체에 종속되도록 만들어야 합니다.

- 잘못된 예와 올바른 예
  
```
주문ID | 상품ID | 상품명
------------------------
101    | A1     | 사과
101    | B1     | 바나나
```

```
주문 테이블

주문ID
------
101

상품 테이블

상품ID | 상품명
------
A1    | 사과
B1    | 바나나
```

- 위의 잘못된 예에서는 상품명이 상품 ID에만 의존하고 있습니다. 기본키의 일부에만 종속되는 부분 함수 종속이 있기 때문에
- 아래의 예에서는 상품명이 기본키(상품 ID) 전체에만 의존하도록 만들었습니다.

#### 3NF(제3정규형) : 이행적 함수 종속 제거
- 기본키가 아닌 속성들끼리 서로 종속되지 않도록 만드는 것을 말합니다.
- 이는 중간 단계의 종속성을 제거하는 것입니다.

```
학생ID | 이름 | 학과 | 학과장
1      | 철수 | 컴퓨터공학 | 김교수
```

```
학생 테이블
학생ID | 이름   | 학과
1      | 철수   | 컴퓨터공학

학과 테이블
학과       | 학과장
컴퓨터공학 | 김교수
```

- 위의 잘못된 예에서는 학과장이 학과에 의존하고 있습니다. 즉, 다시 말해서 학과장은 학과라는 속성에 의해 결정이 됩니다.
- 그렇지만 잘못된 예에서 학과는 기본키가 아닌 학생 ID라는 기본키에 연결된 속성입니다.
- 즉 학과장이 학생 ID를 통해 간접적으로 결정되게 되는데, 이러한 관계를 이행적 함수 종속이라고 합니다. ( 학생 ID -> 학과 -> 학과장 )

- 아래 예시처럼 테이블을 분리하면 이행적 함수 종속이 제거되고, 각 테이블이 기본키에만 종속되게 됩니다.

결정자와 후보키
--------------------------------------------------------------------------------
- 결정자(Determinant) : 어떤 속성을 알면 나머지 속성들의 값을 알게 해주는 속성을 말합니다. ( 모든 속성을 결정할 필요는 없습니다. )
- 예를 들어 학생 ID가 결정자라면, 학생 ID만으로도 이름, 학과, 전화번호 등의 정보가 결정된다는 뜻입니다.

- 후보키 : 키본키가 될 수 있는 속성들의 집합, 즉 테이블에서 각 레코드를 고유하게 식별할 수 있는 최소 집합을 말합니다.
- 후보키는 여러 개 일 수 있고, 그 중 하나를 기본키로 선택할 수 있습니다.
- 후보키는 중복되지 않는 유일한 값을 가져야하며 최소성을 가져야 합니다.
- 최소성을 갖는다는 말은 후보키에서 하나의 속성을 제거하면 더 이상 유일성을 유지할 수 없는 특성을 말합니다. 

```
학생ID | 이름   | 학과        | 전화번호
1      | 철수   | 컴퓨터공학  | 010-1234
2      | 영희   | 수학과      | 010-5678
```

- 위의 경우 학생 ID만 알면 학생명, 학과, 전화번호를 모두 알 수 있기 때문에 학생 ID가 결정자가 됩니다.
  
```
학생ID | 이름   | 학번    | 학과
1      | 철수   | 2023001 | 컴퓨터공학
2      | 영희   | 2023002 | 수학과
```

- 위의 경우 학생 ID와 학번이 각각 후보키입니다. 이는 두 속성 모두 각각 학생을 유일하게 식별할 수 있기 때문입니다.
- 학생 ID만 있어도 학생을 식별할 수 있고, 학번만 있어도 학생을 식별할 수 있습니다.
- 이 경우 두 개 모두 후보키가 될 수 있지만 하나를 기본키로 선택할 수 있습니다.

```
학번  | 이름  | 학과       | 학과장
1001 | 철수  | 컴퓨터공학 | 김교수
1002 | 영희  | 컴퓨터공학 | 김교수
1003 | 민수  | 전자공학   | 박교수
1004 | 지영  | 전자공학   | 박교수
```

- 학번이 결정되면 이름, 학과, 학과장을 유일하게 결정할 수 있으므로 학번은 결정자이면서 동시에 후보키입니다.
- 학과가 결정되면 학과장을 알 수 있으므로 학과는 결정자이지만, 학과는 중복이 발생할 수 있으므로 후보키는 아닙니다. ( 유일성 보장이 안됩니다. )

#### BCNF(보이스-코드 정규형) : 모든 결정자가 후보키가 되도록 만드는 것
- BCNF는 3NF의 업그레이드 버전으로, 기본키 자체가 잘못 정의된 경우를 고치는 단계를 말합니다.
- 주로 복잡한 관계를 가지는 테이블에서 발생합니다.

#### 4NF(제4정규형) : 다치 종속을 제거하는 것
- 4NF는 한 속성이 여러 값을 가질 때 중복을 제거하는 것을 말합니다.
- 다치 종속(MVD) 문제를 해결합니다.
- 다치 종속 : 어떤 속성 A가 정해질 때, 다른 속성 B가 여러 값을 가질 수 있는 상황을 말합니다.

```
학생ID | 수강과목 | 동아리
1      | 수학     | 축구부
1      | 영어     | 축구부
1      | 수학     | 농구부
1      | 영어     | 농구부
```

```
학생ID | 수강과목
1      | 수학
1      | 영어

학생ID | 동아리
1      | 축구부
1      | 농구부
```

- 위의 예시에서 학생 ID는 수강과목과 동아리 두개의 속성에 대해서 각각 여러 값을 가질 수 있습니다.
- 즉, 학생 ID는 수학과 영어를 수강하고, 축구부와 농구부에 각각 속해 있다는 다치 종속 문제가 발생하고 있습니다.

#### 5NF(제5정규형) - 조인 종속성 제거(Join Dependency)
- 5NF는 모든 조합이 올바르게 분리되도록 만드는 것을 말합니다.
- 이는 데이터를 가능한 작은 조각으로 분해해서 불필요한 중복을 완전히 없애는 단계를 말합니다.
- 조인으로 인해 발생하는 중복만 없애는 것이 5NF입니다.
- 조인 종속성 : 여러 테이블로 분해된 데이터를 조합할 때 원래 테이블과 동일한 정보가 나오는 것을 말합니다.

```
강사ID | 과목   | 장소
A      | 수학   | 강의실1
A      | 영어   | 강의실1
B      | 수학   | 강의실2
```

```
강사ID | 과목
A      | 수학
A      | 영어
B      | 수학

과목   | 장소
수학   | 강의실1
영어   | 강의실2
```

- 위의 예시에서는 A 강사가 영어를 강의실 1에서 가르친다는 정보를 추가했을 때 강의실 1이라는 정보가 중복으로 들어가게 됩니다.
- 그래서 강사와 과목, 과목과 장소로 나누었습니다.

#### 6NF(제6정규형) - 무손실 분해
- 데이터 중복을 완전히 없애고, 데이터가 여러 테이블로 분해되더라도 데이터의 정보 손실이 없도록 막는 단계를 말합니다.

